Aggregate Analysis
==================

Analyze empirical or simulated aggregates.

Aggregates are assumed to consist of two sets of coordinate files formatted as
generated by the ``simulate_3d_aggregate_mixing.py`` script. These coordinate
files represent two different cell populations, called ``green`` and ``red``,
mixed together into a single aggregate.

A folder of multiple aggregate coordinates can be analyzed all at once using the
``analyze_3d_aggregate_mixing.py`` script.

.. code-block:: bash

    $ ./analyze_3d_aggregate_mixing.py \
          --plot-point-cloud \
          --group-type split_label \
          ../data/empirical_pos

Where ``--group-type`` can be one of the following:

* ``split_label``: The coordinate files are pairs of ``mKate`` and ``GFP`` positive
    cells. Coordinates that are ``GFP`` positive represent **ONLY** the ``green``
    cells, while coordinates that are ``mKate`` positive represent **ONLY** the
    ``red`` cells.
* ``double_green``: The coordinate files are pairs of ``green`` and ``spot`` cells.
    Coordinates in the ``spot`` cells represent both ``green`` **AND** ``red``
    cells (e.g. they are from a pan-nuclear stain like DAPI). Coordinates in the
    ``green`` file represent only the ``green`` cells. Non-green cells are assumed
    to be ``red``.
* ``double_red``: The coordinate files are pairs of ``red`` and ``spot`` cells,
    where spot cells represent both ``green`` **AND** ``red`` cells, while coordinates
    in the ``red`` file represent only the ``red`` (e.g. the inverse of ``double_green``)

By default, simulated files are generated as ``double_green``. The example empirical
files should be analyzed as ``split_label``.

See the command-line help with ``./analyze_3d_aggregate_mixing.py -h``

API Reference
-------------

.. automodule:: cm_microtissue_struct.aggregate
   :members:
   :undoc-members:
